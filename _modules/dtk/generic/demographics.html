

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dtk.generic.demographics &mdash; DTK Package 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="DTK Package 0.1 documentation" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../../index.html" class="icon icon-home"> DTK Package
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generic/index.html">Generic package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/climate.html">Climate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/demographics.html">Demographics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/disease.html">Disease</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/geography.html">Geography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/migration.html">Migration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/params.html">Params</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../generic/properties.html">Properties</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../interventions/index.html">Interventions package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/empty_campaign.html">Empty campaign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/habitat_scale.html">Habitat scale campaign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/health_seeking.html">Health seeking campaign</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/inputs_EIR.html">Inputs EIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/irs.html">IRS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/itn.html">ITN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/ivernectin.html">Ivermectin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/malaria_challenge.html">Malaria Challenge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/malaria_drugs.html">Malaria drugs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/malaria_vaccine.html">Malaria vaccine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../interventions/outbreak.html">Outbreak</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../malaria/index.html">Malaria package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../malaria/immunity.html">Immunity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../malaria/infection.html">Infection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../malaria/params.html">Params</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../malaria/symptoms.html">Symptoms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/index.html">Tools package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/calibration/index.html">Calibration tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/calibration/IMIS.html">IMIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/calibration/calibtool/index.html">Calibtool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tools/calibration/calibtool/overview.html">1. Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tools/calibration/calibtool/running.html">2. Running CalibTool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tools/calibration/calibtool/adding.html">3. Adding a new malaria site or analyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tools/calibration/calibtool/modifying.html">4. Modifying updater for new parameter sampling method</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../tools/calibration/calibtool/running_outside.html">5. Running outside Edward&#8217;s python tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/climate/index.html">Climate tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/climate/display_climate.html">Display climate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/climate/large_data.html">Large data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/demographics/index.html">Demographics tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/demographics/compiledemog.html">Compiledemog script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/demographics/createimmunelayer.html">Createimmunelayer script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/demographics/osm2nx.html">osm2nx converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/demographics/shp2nx.html">shp2nx converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../tools/demographics/visualize_nodes.html">visualize_nodes script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tools/separatrix/index.html">Separatrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../utils.html">Utils package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../vector.html">Vector package</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">DTK Package</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      
    <li>dtk.generic.demographics</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for dtk.generic.demographics</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;Demographics_Filenames&quot;</span><span class="p">:</span> <span class="p">[],</span>

    <span class="s">&quot;Population_Scale_Type&quot;</span><span class="p">:</span> <span class="s">&quot;FIXED_SCALING&quot;</span><span class="p">,</span>
    <span class="s">&quot;Base_Population_Scale_Factor&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="s">&quot;Enable_Aging&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Age_Initialization_Distribution_Type&quot;</span><span class="p">:</span> <span class="s">&quot;DISTRIBUTION_SIMPLE&quot;</span><span class="p">,</span>

    <span class="s">&quot;Enable_Demographics_Birth&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Enable_Demographics_Gender&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Enable_Demographics_Initial&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Enable_Demographics_Other&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Enable_Demographics_Reporting&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

    <span class="s">&quot;Enable_Immunity_Initialization_Distribution&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  <span class="c"># compatibility with EMOD v2.0 and earlier</span>
    <span class="s">&quot;Immunity_Initialization_Distribution_Type&quot;</span><span class="p">:</span> <span class="s">&quot;DISTRIBUTION_OFF&quot;</span><span class="p">,</span>

    <span class="s">&quot;Enable_Vital_Dynamics&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Death_Rate_Dependence&quot;</span><span class="p">:</span> <span class="s">&quot;NONDISEASE_MORTALITY_BY_AGE_AND_GENDER&quot;</span><span class="p">,</span>
    <span class="s">&quot;Enable_Birth&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Birth_Rate_Dependence&quot;</span><span class="p">:</span> <span class="s">&quot;POPULATION_DEP_RATE&quot;</span><span class="p">,</span>
    <span class="s">&quot;Birth_Rate_Time_Dependence&quot;</span><span class="p">:</span> <span class="s">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="s">&quot;x_Birth&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="s">&quot;Enable_Disease_Mortality&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">&quot;Base_Mortality&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">&quot;Mortality_Time_Course&quot;</span><span class="p">:</span> <span class="s">&quot;DAILY_MORTALITY&quot;</span><span class="p">,</span>
    <span class="s">&quot;x_Other_Mortality&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="s">&quot;Individual_Sampling_Type&quot;</span><span class="p">:</span> <span class="s">&quot;TRACK_ALL&quot;</span><span class="p">,</span>
    <span class="s">&quot;Base_Individual_Sample_Rate&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c">## all parameters below are unused without sampling</span>
    <span class="s">&quot;Max_Node_Population_Samples&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_0_18mo&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_10_14&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_15_19&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_18mo_4yr&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_20_Plus&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_5_9&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;Sample_Rate_Birth&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>

<span class="n">distribution_types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;CONSTANT_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s">&quot;UNIFORM_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;GAUSSIAN_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s">&quot;EXPONENTIAL_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">&quot;POISSON_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s">&quot;LOG_NORMAL&quot;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">&quot;BIMODAL_DISTRIBUTION&quot;</span> <span class="p">:</span> <span class="mi">6</span>
    <span class="p">}</span>


<div class="viewcode-block" id="set_risk_mod"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.set_risk_mod">[docs]</a><span class="k">def</span> <span class="nf">set_risk_mod</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the ``RiskDistributionFlag``, ``RiskDistribution1`` and ``RiskDistribution2`` in a demographics file.</span>

<span class="sd">    :param filename: The demographics file location</span>
<span class="sd">    :param distribution: The selected distribution (need to come from ``distribution_types``)</span>
<span class="sd">    :param par1: Parameter 1 of the distribution</span>
<span class="sd">    :param par2: Parameter 2 of the distribution (may be unused depending on the selected distribution)</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set_demog_distributions</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;Risk&quot;</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">)])</span>

</div>
<div class="viewcode-block" id="set_immune_mod"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.set_immune_mod">[docs]</a><span class="k">def</span> <span class="nf">set_immune_mod</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the ``ImmunityDistributionFlag``, ``ImmunityDistribution1`` and ``ImmunityDistribution2`` in a demographics file.</span>

<span class="sd">    :param filename: The demographics file location</span>
<span class="sd">    :param distribution: The selected distribution (need to come from `distribution_types`)</span>
<span class="sd">    :param par1: Parameter 1 of the distribution</span>
<span class="sd">    :param par2: Parameter 2 of the distribution (may be unused depending on the selected distribution)</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">set_demog_distributions</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;Immunity&quot;</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">)])</span>

</div>
<div class="viewcode-block" id="apply_to_defaults_or_nodes"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.apply_to_defaults_or_nodes">[docs]</a><span class="k">def</span> <span class="nf">apply_to_defaults_or_nodes</span><span class="p">(</span><span class="n">demog</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the ``fn`` function either to the ``Defaults`` dictionary or to each of the nodes depending</span>
<span class="sd">    if the ``IndividualAttributes`` parameter is present in the ``Defaults`` or not.</span>

<span class="sd">    .. todo::</span>
<span class="sd">        This function should be refactored to look at both the ``Defaults`` and each individual nodes.</span>
<span class="sd">        It will make sure that if a node override the default ``IndividualAttributes`` the change will still</span>
<span class="sd">        be effective.</span>

<span class="sd">    :param demog: The demographic file represented as a dictionary</span>
<span class="sd">    :param fn: The function to apply the ``Defaults`` or individual nodes</span>
<span class="sd">    :param args: Argument list needed by ``fn``</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s">&quot;Defaults&quot;</span> <span class="ow">in</span> <span class="n">demog</span> <span class="ow">and</span> <span class="s">&quot;IndividualAttributes&quot;</span> <span class="ow">in</span> <span class="n">demog</span><span class="p">[</span><span class="s">&quot;Defaults&quot;</span><span class="p">]:</span>
        <span class="n">fn</span><span class="p">(</span><span class="n">demog</span><span class="p">[</span><span class="s">&quot;Defaults&quot;</span><span class="p">],</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">demog</span><span class="p">[</span><span class="s">&quot;Nodes&quot;</span><span class="p">]:</span>
            <span class="n">fn</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="set_demog_distributions"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.set_demog_distributions">[docs]</a><span class="k">def</span> <span class="nf">set_demog_distributions</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">distributions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply distributions to a given demographics file.</span>
<span class="sd">    The distributions needs to be formatted as a list of (name, distribution, par1, par2) with:</span>

<span class="sd">    * **name:** Immunity, Risk, Age, Prevalence or MigrationHeterogeneity</span>
<span class="sd">    * **distribution:** One distribution contained in ``distribution_types``</span>
<span class="sd">    * **par1, par2:** the values for the distribution parameters</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Set the PrevalenceDistribution to a uniform distribution with 0.1 and 0.2</span>
<span class="sd">        # and the ImmunityDistributionFlag to a constant distribution with 1</span>
<span class="sd">        demog = json.load(open(&quot;demographics.json&quot;,&quot;r&quot;))</span>
<span class="sd">        distributions = list()</span>
<span class="sd">        distributions.add((&quot;Prevalence&quot;,&quot;UNIFORM_DISTRIBUTION&quot;,0.1,0.2))</span>
<span class="sd">        distributions.add((&quot;Immunity&quot;,&quot;CONSTANT_DISTRIBUTION&quot;,1,0))</span>
<span class="sd">        set_demog_distribution(demog, distributions)</span>

<span class="sd">    :param filename: the demographics file as json</span>
<span class="sd">    :param distributions: the different distributions to set contained in a list</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="s">&quot;r&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">demogjson_file</span><span class="p">:</span>
        <span class="n">demog</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span> <span class="n">demogjson_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_attributes</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">dist_type</span><span class="p">,</span><span class="n">par1</span><span class="p">,</span><span class="n">par2</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;IndividualAttributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="n">dist_type</span> <span class="o">+</span> <span class="s">&quot;DistributionFlag&quot;</span><span class="p">:</span> <span class="n">distribution_types</span><span class="p">[</span><span class="n">distribution</span><span class="p">],</span>
             <span class="n">dist_type</span> <span class="o">+</span> <span class="s">&quot;Distribution1&quot;</span><span class="p">:</span> <span class="n">par1</span><span class="p">,</span>
             <span class="n">dist_type</span> <span class="o">+</span> <span class="s">&quot;Distribution2&quot;</span><span class="p">:</span> <span class="n">par2</span><span class="p">})</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">dist_type</span><span class="p">,</span> <span class="n">distribution</span><span class="p">,</span> <span class="n">par1</span><span class="p">,</span> <span class="n">par2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">distributions</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">distribution</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">distribution_types</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Don&#39;t recognize distribution type </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">distribution</span><span class="p">)</span>

        <span class="n">apply_to_defaults_or_nodes</span><span class="p">(</span><span class="n">demog</span><span class="p">,</span><span class="n">set_attributes</span><span class="p">,</span><span class="n">dist_type</span><span class="p">,</span><span class="n">par1</span><span class="p">,</span><span class="n">par2</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="n">demog</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span> <span class="p">)</span>

</div>
<div class="viewcode-block" id="set_static_demographics"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.set_static_demographics">[docs]</a><span class="k">def</span> <span class="nf">set_static_demographics</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">use_existing</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a static demographics based on the demographics file specified in the config file</span>
<span class="sd">    of the :py:class:`DTKConfigBuilder` object passed to the function.</span>

<span class="sd">    This function takes the current demographics file and adjust the birth rate/death rate</span>
<span class="sd">    to get a static population (the deaths are always compensated by new births).</span>

<span class="sd">    .. todo::</span>
<span class="sd">        Make sure that the population is 1000 individuals. For now rely on the fact that the base</span>
<span class="sd">        demographics file will be 1000 Initial Population.</span>

<span class="sd">    :param cb: The config builder object</span>
<span class="sd">    :param use_existing: If ``True`` will only take the demographics file name and add the .static to it. If ``False`` will create a static demographics file based on the specified demographics file.</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">demog_filenames</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="s">&#39;Demographics_Filenames&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">demog_filenames</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;Expecting only one demographics filename.&#39;</span><span class="p">)</span>
    <span class="n">demog_filename</span> <span class="o">=</span> <span class="n">demog_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">static_demog_filename</span> <span class="o">=</span> <span class="n">demog_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;compiled.&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;.json&quot;</span><span class="p">,</span> <span class="s">&quot;.static.json&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s">&quot;Demographics_Filenames&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">static_demog_filename</span><span class="p">])</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s">&quot;Birth_Rate_Dependence&quot;</span><span class="p">,</span> <span class="s">&quot;FIXED_BIRTH_RATE&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_existing</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">demog_filename</span><span class="p">,</span> <span class="s">&quot;r&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">demogjson_file</span><span class="p">:</span>
        <span class="n">demog</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span> <span class="n">demogjson_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="p">)</span>

    <span class="n">birthrate</span> <span class="o">=</span> <span class="mf">0.12329</span>
    <span class="n">exponential_age_param</span> <span class="o">=</span> <span class="mf">0.000118</span>
    <span class="n">population_removal_rate</span> <span class="o">=</span> <span class="mi">45</span>
    <span class="n">mod_mortality</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">&quot;NumDistributionAxes&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s">&quot;AxisNames&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s">&quot;gender&quot;</span><span class="p">,</span> <span class="s">&quot;age&quot;</span> <span class="p">],</span>
                    <span class="s">&quot;AxisUnits&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s">&quot;male=0,female=1&quot;</span><span class="p">,</span> <span class="s">&quot;years&quot;</span> <span class="p">],</span>
                    <span class="s">&quot;AxisScaleFactors&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">365</span> <span class="p">],</span>
                    <span class="s">&quot;NumPopulationGroups&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
                    <span class="s">&quot;PopulationGroups&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
                        <span class="p">[</span> <span class="mi">0</span> <span class="p">]</span>
                    <span class="p">],</span>
                    <span class="s">&quot;ResultUnits&quot;</span><span class="p">:</span> <span class="s">&quot;annual deaths per 1000 individuals&quot;</span><span class="p">,</span>
                    <span class="s">&quot;ResultScaleFactor&quot;</span><span class="p">:</span> <span class="mf">2.74e-06</span><span class="p">,</span>
                    <span class="s">&quot;ResultValues&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span> <span class="n">population_removal_rate</span> <span class="p">],</span>
                        <span class="p">[</span> <span class="n">population_removal_rate</span> <span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">}</span>

    <span class="k">def</span> <span class="nf">set_attributes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;IndividualAttributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span><span class="s">&quot;MortalityDistribution&quot;</span><span class="p">:</span> <span class="n">mod_mortality</span><span class="p">,</span>
             <span class="s">&quot;AgeDistributionFlag&quot;</span><span class="p">:</span> <span class="n">distribution_types</span><span class="p">[</span><span class="s">&quot;EXPONENTIAL_DISTRIBUTION&quot;</span><span class="p">],</span>
             <span class="s">&quot;AgeDistribution1&quot;</span><span class="p">:</span> <span class="n">exponential_age_param</span><span class="p">})</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;NodeAttributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;BirthRate&quot;</span><span class="p">:</span> <span class="n">birthrate</span><span class="p">})</span>

    <span class="n">apply_to_defaults_or_nodes</span><span class="p">(</span><span class="n">demog</span><span class="p">,</span><span class="n">set_attributes</span><span class="p">)</span>

    <span class="n">output_file_path</span> <span class="o">=</span> <span class="n">demog_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;.json&quot;</span><span class="p">,</span><span class="s">&quot;.static.json&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">output_file_path</span><span class="p">,</span> <span class="s">&quot;w&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="n">demog</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span> <span class="p">)</span>

</div>
<div class="viewcode-block" id="set_growing_demographics"><a class="viewcode-back" href="../../../generic/demographics.html#dtk.generic.demographics.set_growing_demographics">[docs]</a><span class="k">def</span> <span class="nf">set_growing_demographics</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span><span class="n">use_existing</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function creates a growing population. It works the same way as the :any:`set_static_demographics` but with</span>
<span class="sd">    a birth rate more important than the death rate which leads to a growing population.</span>

<span class="sd">    .. todo::</span>
<span class="sd">        Make sure that the population is 1000 individuals. For now rely on the fact that the base</span>
<span class="sd">        demographics file will be 1000 Initial Population.</span>

<span class="sd">    :param cb: The :py:class:`DTKConfigBuilder &lt;dtk.utils.core.DTKConfigBuilder&gt;` object</span>
<span class="sd">    :param use_existing: If ``True`` will only take the demographics file name and add the .growing to it. If ``False`` will create a growing demographics file based on the specified demographics file.</span>
<span class="sd">    :return: Nothing</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">demog_filenames</span><span class="o">=</span><span class="n">cb</span><span class="o">.</span><span class="n">get_param</span><span class="p">(</span><span class="s">&#39;Demographics_Filenames&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">demog_filenames</span><span class="p">)</span><span class="o">!=</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;Expecting only one demographics filename.&#39;</span><span class="p">)</span>
    <span class="n">demog_filename</span><span class="o">=</span><span class="n">demog_filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">growing_demog_filename</span><span class="o">=</span><span class="n">demog_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;compiled.&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;.json&quot;</span><span class="p">,</span><span class="s">&quot;.growing.json&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s">&quot;Demographics_Filenames&quot;</span><span class="p">,[</span><span class="n">growing_demog_filename</span><span class="p">])</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_param</span><span class="p">(</span><span class="s">&quot;Birth_Rate_Dependence&quot;</span><span class="p">,</span><span class="s">&quot;POPULATION_DEP_RATE&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_existing</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">demog_filename</span><span class="p">,</span> <span class="s">&quot;r&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">demogjson_file</span><span class="p">:</span>
        <span class="n">demog</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span> <span class="n">demogjson_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="p">)</span>

    <span class="n">birthrate</span> <span class="o">=</span> <span class="mf">0.0001</span>
    <span class="n">mod_mortality</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s">&quot;NumDistributionAxes&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s">&quot;AxisNames&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s">&quot;gender&quot;</span><span class="p">,</span> <span class="s">&quot;age&quot;</span> <span class="p">],</span>
                    <span class="s">&quot;AxisUnits&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s">&quot;male=0,female=1&quot;</span><span class="p">,</span> <span class="s">&quot;years&quot;</span> <span class="p">],</span>
                    <span class="s">&quot;AxisScaleFactors&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">365</span> <span class="p">],</span>
                    <span class="s">&quot;NumPopulationGroups&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">],</span>
                    <span class="s">&quot;PopulationGroups&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">],</span>
                        <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span> <span class="p">]</span>
                    <span class="p">],</span>
                    <span class="s">&quot;ResultUnits&quot;</span><span class="p">:</span> <span class="s">&quot;annual deaths per 1000 individuals&quot;</span><span class="p">,</span>
                    <span class="s">&quot;ResultScaleFactor&quot;</span><span class="p">:</span> <span class="mf">2.74e-06</span><span class="p">,</span>
                    <span class="s">&quot;ResultValues&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">400</span> <span class="p">],</span>
                        <span class="p">[</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">400</span> <span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">}</span>

    <span class="k">def</span> <span class="nf">set_attributes</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;IndividualAttributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;MortalityDistribution&quot;</span><span class="p">:</span> <span class="n">mod_mortality</span><span class="p">})</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;NodeAttributes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&quot;BirthRate&quot;</span><span class="p">:</span> <span class="n">birthrate</span><span class="p">})</span>

    <span class="n">apply_to_defaults_or_nodes</span><span class="p">(</span><span class="n">demog</span><span class="p">,</span><span class="n">set_attributes</span><span class="p">)</span>

    <span class="n">output_file_path</span> <span class="o">=</span> <span class="n">demog_filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;.json&quot;</span><span class="p">,</span><span class="s">&quot;.growing.json&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span> <span class="n">output_file_path</span><span class="p">,</span> <span class="s">&quot;w&quot;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span> <span class="n">demog</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span> <span class="p">)</span></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Institute for Disease Modeling (IDM).
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>